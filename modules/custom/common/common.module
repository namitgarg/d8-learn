<?php

/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
namespace Drupal\common;
use Drupal\Core\Routing\RouteMatchInterface;

function common_theme(array $existing, $type, $theme, $path) {
  return array(
    'common_template' => array(
      'template' => 'common',
      'variables' => array(
        'variable1' => NULL,
      ),
    ),
  );
}

/**
 * Template preprocess function
 *
 * @param array $variables
 *   An associative array containing:
 *   - source_text
 */
function template_preprocess_common(&$variables) {

}

/*
 * Add JS for View blocks.
 */
function common_views_pre_render($view) {
  if ($view->storage->id() == 'leadership' && $view->current_display == 'block_1') {
    $view->element['#attached']['library'][] = 'common/leadership_lib';
  }
  if ($view->storage->id() == 'board_of_directors' && $view->current_display == 'block_1') {
    $view->element['#attached']['library'][] = 'common/bod_lib';
  }
  if ($view->storage->id() == 'career_page_reviews' && $view->current_display == 'block_1') {
//    $result = $view->result;
//    foreach ($result as $i => $row) {
//      $view->result[$i]->_entity->set('field_name','test');
//      $view->result[$i]->field_name[0]['rendered']['#markup'] = "The new text";
//
//    }
// 
//    $view->field['nothing']->options['alter']['text'] = 'My custom tesxt';

  }
  
}

/*
 * Add Js for Main menu on every page
 */
function common_page_attachments(array &$page) {
  $page['#attached']['library'][] = 'common/main-menu';
}



//function common_form_alter(&$form, \Drupal\Core\Form\FormStateInterface $form_state, $form_id) {
//  print_r($form_id);
//}

function common_form_webform_submission_partnership_node_47_form_alter(&$form, \Drupal\Core\Form\FormStateInterface $form_state, $form_id) {
  print_r($form_id);
  $form['elements']['email_address']['#ajax'] = array(
        'callback' => 'commonEmailValidation',
        'effect' => 'none',
        'event' => 'change',
        'method' => 'replace',
        'progress' => array(
//          'type' => 'throbber',
          'message' => NULL,
        ),
      );
  kint($form['elements']['email_address']);
}
